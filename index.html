<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drudge代币铸造</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }
        
        .anime-bg-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            z-index: 0;
            background-image: 
                radial-gradient(circle at 10% 20%, #ff6b6b 0%, transparent 15%),
                radial-gradient(circle at 90% 80%, #4ecdc4 0%, transparent 20%),
                radial-gradient(circle at 50% 30%, #ff9e7d 0%, transparent 18%),
                radial-gradient(circle at 30% 70%, #7e7eff 0%, transparent 22%);
        }
        
        .container {
            max-width: 900px;
            width: 100%;
            background: rgba(19, 23, 42, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
            border: 4px solid #4ecdc4;
            z-index: 10;
        }
        
        .header {
            background: linear-gradient(to right, #ff6b6b, #4ecdc4);
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .lang-switch {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255, 255, 255, 0.3);
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 20;
            font-size: 1rem;
        }
        
        .lang-switch:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .header h1 {
            color: white;
            font-size: 2.8rem;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4);
            margin: 10px 0;
            letter-spacing: 1px;
            position: relative;
            z-index: 2;
            font-weight: 700;
        }
        
        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
            font-weight: 300;
        }
        
        .content {
            padding: 30px;
        }
        
        .meme-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .meme {
            width: 100%;
            max-width: 500px;
            height: 280px;
            background: linear-gradient(45deg, #1f4068, #1b1b2f);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 3px solid #4ecdc4;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .meme-text {
            text-align: center;
            font-weight: bold;
            color: #fff;
            font-size: 1.8rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
            padding: 0 10px;
            margin-top: 20px;
            font-style: italic;
            line-height: 1.4;
        }
        
        .meme-icons {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .meme-icon {
            font-size: 5rem;
            color: #ff6b6b;
            animation: float 3s ease-in-out infinite;
        }
        
        .meme-icon:nth-child(2) {
            color: #4ecdc4;
            animation-delay: 0.5s;
        }
        
        .stats {
            background: rgba(30, 35, 58, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #ff6b6b;
        }
        
        .progress-container {
            margin: 25px 0;
        }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 1rem;
            color: #e2e8f0;
        }
        
        .progress-bar {
            height: 35px;
            background: rgba(20, 25, 45, 0.8);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: inset 0 1px 5px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4ecdc4, #1a936f);
            width: 81.6%;
            border-radius: 18px;
            transition: width 1s ease;
            position: relative;
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.5);
        }
        
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 25px;
        }
        
        .stat-card {
            background: rgba(25, 30, 50, 0.7);
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(126, 126, 255, 0.3);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .stat-label {
            font-size: 1rem;
            color: #a0aec0;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffcc00;
            margin: 5px 0;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
        }
        
        .stat-desc {
            font-size: 0.9rem;
            color: #cbd5e0;
        }
        
        .mint-section {
            background: rgba(30, 35, 58, 0.8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 2px solid #ff6b6b;
        }
        
        .mint-section h2 {
            color: #ffcc00;
            text-align: center;
            margin-bottom: 25px;
            font-size: 2rem;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.2);
        }
        
        .wallet-info {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .wallet-address {
            background: rgba(25, 30, 50, 0.7);
            padding: 10px 20px;
            border-radius: 25px;
            font-family: monospace;
            font-size: 1rem;
            max-width: 220px;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #4ecdc4;
            border: 1px solid rgba(78, 205, 196, 0.3);
        }
        
        .connect-btn {
            background: linear-gradient(to right, #4ecdc4, #1a936f);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 25px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .connect-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #e2e8f0;
            font-size: 1.1rem;
        }
        
        input {
            width: 100%;
            padding: 15px;
            background: rgba(20, 25, 45, 0.8);
            border: 2px solid #4ecdc4;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s;
            color: white;
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.2);
        }
        
        input:focus {
            border-color: #ff6b6b;
            outline: none;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.4);
        }
        
        .amount-info {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.95rem;
            color: #a0aec0;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: linear-gradient(to right, #ff6b6b, #ff9e7d);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 12px rgba(255, 107, 107, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 15px;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.6);
        }
        
        .btn:active {
            transform: translateY(2px);
        }
        
        .btn:disabled {
            background: #4a5568;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }
        
        .token-info {
            margin-top: 25px;
            text-align: center;
            font-size: 1.1rem;
            color: #cbd5e0;
            padding: 15px;
            border-radius: 12px;
            background: rgba(25, 30, 50, 0.5);
            border: 1px solid rgba(255, 204, 0, 0.2);
        }
        
        .token-highlight {
            color: #ffcc00;
            font-weight: bold;
            font-size: 1.3rem;
        }
        
        .message {
            padding: 18px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            display: none;
            font-size: 1.1rem;
        }
        
        .success {
            background: rgba(72, 187, 120, 0.2);
            color: #48bb78;
            border: 1px solid rgba(72, 187, 120, 0.4);
        }
        
        .error {
            background: rgba(245, 101, 101, 0.2);
            color: #f56565;
            border: 1px solid rgba(245, 101, 101, 0.4);
        }
        
        .info {
            background: rgba(56, 178, 172, 0.2);
            color: #38b2ac;
            border: 1px solid rgba(56, 178, 172, 0.4);
        }
        
        .success-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            font-size: 5rem;
            color: #ffcc00;
            opacity: 0;
            pointer-events: none;
            text-shadow: 0 0 20px rgba(255, 204, 0, 0.8);
        }
        
        .counter-section {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        
        .counter-card {
            background: rgba(25, 30, 50, 0.7);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            flex: 1;
            margin: 0 10px;
            border: 1px solid rgba(126, 126, 255, 0.3);
        }
        
        .counter-label {
            font-size: 1rem;
            color: #a0aec0;
            margin-bottom: 8px;
        }
        
        .counter-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ff6b6b;
        }
        
        @keyframes move {
            0% { transform: translateX(0); }
            25% { transform: translateX(20px) translateY(-10px); }
            50% { transform: translateX(0) translateY(0); }
            75% { transform: translateX(-20px) translateY(10px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes coin-fly {
            0% { 
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% { 
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.5);
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .meme-text {
                font-size: 1.5rem;
            }
            
            .mint-section h2 {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .meme-text {
                font-size: 1.2rem;
            }
            
            .mint-section h2 {
                font-size: 1.5rem;
            }
            
            .wallet-info {
                flex-direction: column;
            }
            
            .counter-section {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="anime-bg-pattern"></div>
    
    <div class="container">
        <div class="header">
            <button class="lang-switch" id="langSwitch">
                <span>EN</span>
                <i class="fas fa-globe"></i>
            </button>
            <h1 id="title">Drudge代币铸造</h1>
            <p id="subtitle">讽刺当代牛马生活的动漫风格Meme代币 - 用幽默反抗996</p>
        </div>
        
        <div class="content">
            <div class="meme-container">
                <div class="meme">
                    <div class="meme-icons">
                        <i class="fas fa-bull meme-icon"></i>
                        <i class="fas fa-horse meme-icon"></i>
                    </div>
                    <div class="meme-text" id="memeText">"加班使我快乐，工资使我自由"</div>
                </div>
            </div>
            
            <div class="stats">
                <h2 id="progressTitle">铸造进度</h2>
                <div class="progress-container">
                    <div class="progress-labels">
                        <span>0 BNB</span>
                        <span id="targetAmount">5 BNB</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">
                            <div class="progress-text" id="progressText">81.60%</div>
                        </div>
                    </div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label" id="raisedLabel">已募集</div>
                        <div class="stat-value" id="raisedAmount">4.08 BNB</div>
                        <div class="stat-desc" id="targetLabel">目标: 5 BNB</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" id="remainingLabel">剩余额度</div>
                        <div class="stat-value" id="remainingAmount">0.92 BNB</div>
                        <div class="stat-desc" id="statusText">即将售罄</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" id="priceLabel">当前价格</div>
                        <div class="stat-value">0.02 BNB</div>
                        <div class="stat-desc" id="rateLabel">= 1000 DRUDGE</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" id="mintedLabel">已铸造</div>
                        <div class="stat-value" id="mintedAmount">204,000</div>
                        <div class="stat-desc" id="tokenLabel">DRUDGE代币</div>
                    </div>
                </div>
            </div>
            
            <div class="mint-section">
                <h2 id="mintTitle">铸造您的Drudge代币</h2>
                
                <div class="wallet-info">
                    <span id="currentWallet">当前钱包:</span>
                    <div class="wallet-address" id="walletAddress">未连接</div>
                    <button class="connect-btn" id="connectBtn">
                        <i class="fas fa-wallet"></i>
                        <span id="connectText">连接钱包</span>
                    </button>
                </div>
                
                <div class="form-group">
                    <label for="bnbAmount" id="bnbAmountLabel">输入BNB数量</label>
                    <input type="number" id="bnbAmount" min="0.02" max="1" step="0.02" value="0.02">
                    <div class="amount-info">
                        <span id="minAmount">最小: 0.02 BNB</span>
                        <span id="maxAmount">最大: 1 BNB</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="receiveAmount" id="receiveLabel">您将收到</label>
                    <input type="text" id="receiveAmount" value="1,000 DRUDGE" readonly>
                </div>
                
                <div class="message" id="message"></div>
                
                <button class="btn" id="mintBtn">
                    <i class="fas fa-coins"></i>
                    <span id="mintBtnText">铸造代币</span>
                </button>
                
                <div class="counter-section">
                    <div class="counter-card">
                        <div class="counter-label" id="userMintedLabel">您已铸造</div>
                        <div class="counter-value" id="userMinted">0</div>
                        <div class="counter-label">DRUDGE代币</div>
                    </div>
                    <div class="counter-card">
                        <div class="counter-label" id="mintCountLabel">铸造次数</div>
                        <div class="counter-value" id="mintCount">0/3</div>
                        <div class="counter-label">剩余铸造次数</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="success-animation" id="successAnimation">
        <i class="fas fa-coins"></i>
    </div>

    <script>
        // 合约ABI - 根据您修改后的合约生成
        const contractABI = [
       	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "recipient",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "distributeTokens",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address payable",
				"name": "_beneficiary",
				"type": "address"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "allowance",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "needed",
				"type": "uint256"
			}
		],
		"name": "ERC20InsufficientAllowance",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "sender",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "balance",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "needed",
				"type": "uint256"
			}
		],
		"name": "ERC20InsufficientBalance",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "approver",
				"type": "address"
			}
		],
		"name": "ERC20InvalidApprover",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "receiver",
				"type": "address"
			}
		],
		"name": "ERC20InvalidReceiver",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "sender",
				"type": "address"
			}
		],
		"name": "ERC20InvalidSender",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			}
		],
		"name": "ERC20InvalidSpender",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "OwnableInvalidOwner",
		"type": "error"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			}
		],
		"name": "OwnableUnauthorizedAccount",
		"type": "error"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "spender",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "oldBeneficiary",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "newBeneficiary",
				"type": "address"
			}
		],
		"name": "BeneficiaryChanged",
		"type": "event"
	},
	{
		"inputs": [],
		"name": "mintTokens",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "previousOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"inputs": [],
		"name": "renounceOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address payable",
				"name": "_newBeneficiary",
				"type": "address"
			}
		],
		"name": "setBeneficiary",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "TokensDistributed",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "bnbAmount",
				"type": "uint256"
			}
		],
		"name": "TokensMinted",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "transfer",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "withdrawBNB",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "spender",
				"type": "address"
			}
		],
		"name": "allowance",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "account",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "beneficiary",
		"outputs": [
			{
				"internalType": "address payable",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "decimals",
		"outputs": [
			{
				"internalType": "uint8",
				"name": "",
				"type": "uint8"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "MAX_PER_ADDRESS",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "MAX_PER_TX",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "MAX_SUPPLY",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "MIN_AMOUNT",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "mintCount",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "TARGET_AMOUNT",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "TOKEN_RATE",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "totalRaised",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "totalSupply",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}  
        ];
        
        // 合约地址（部署后替换为您的合约地址）
        const contractAddress = "0x9bCd062c237a60ddF8895F758999cC0e78995342";
        
        // 全局变量
        let web3;
        let drudgeContract;
        let currentAccount = null;
        let userMintedCount = 0;
        let currentRaised = 4.08;
        const targetAmount = 5;
        
        // 初始化
        window.addEventListener('load', async () => {
            // 初始化以太坊提供者
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                await initContract();
                
                // 添加账户变更监听
                window.ethereum.on('accountsChanged', async (accounts) => {
                    if (accounts.length === 0) {
                        // 用户断开连接
                        currentAccount = null;
                        document.getElementById('walletAddress').textContent = "未连接";
                        document.getElementById('connectBtn').innerHTML = 
                            `<i class="fas fa-wallet"></i> <span id="connectText">连接钱包</span>`;
                        document.getElementById('connectBtn').style.background = 'linear-gradient(to right, #4ecdc4, #1a936f)';
                        document.getElementById('userMinted').textContent = "0";
                        document.getElementById('mintCount').textContent = "0/3";
                    } else {
                        // 账户变更
                        currentAccount = accounts[0];
                        await connectWallet();
                    }
                });
                
                // 添加网络变更监听
                window.ethereum.on('chainChanged', () => {
                    window.location.reload();
                });
            } else {
                showMessage("请安装MetaMask或其他以太坊钱包扩展", "error");
                document.getElementById('connectBtn').disabled = true;
                document.getElementById('mintBtn').disabled = true;
            }
            
            // 设置语言
            updateLanguage(currentLanguage);
            
            // 更新进度条
            updateProgressBar();
            
            // 事件监听器
            document.getElementById('langSwitch').addEventListener('click', toggleLanguage);
            document.getElementById('connectBtn').addEventListener('click', connectWallet);
            document.getElementById('bnbAmount').addEventListener('input', updateReceiveAmount);
            document.getElementById('mintBtn').addEventListener('click', mintTokens);
            
            // 模拟初始化状态
            document.getElementById('userMinted').textContent = "0";
            document.getElementById('mintCount').textContent = "0/3";
        });
        
        // 初始化合约
        async function initContract() {
            try {
                drudgeContract = new web3.eth.Contract(contractABI, contractAddress);
                
                // 获取合约状态
                try {
                    // 获取已筹集的BNB
                    const raised = await drudgeContract.methods.totalRaised().call();
                    currentRaised = parseFloat(web3.utils.fromWei(raised, 'ether'));
                    
                    updateProgressBar();
                } catch (error) {
                    console.error("获取合约数据失败:", error);
                }
            } catch (error) {
                console.error("初始化合约失败:", error);
                showMessage("合约初始化失败，请检查网络", "error");
            }
        }
        
        // 切换语言
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'zh' ? 'en' : 'zh';
            updateLanguage(currentLanguage);
        }
        
        // 更新页面语言
        function updateLanguage(lang) {
            const data = languageData[lang];
            
            // 更新所有文本元素
            document.getElementById('title').textContent = data.title;
            document.getElementById('subtitle').textContent = data.subtitle;
            document.getElementById('memeText').textContent = data.memeText;
            document.getElementById('progressTitle').textContent = data.progressTitle;
            document.getElementById('raisedLabel').textContent = data.raisedLabel;
            document.getElementById('remainingLabel').textContent = data.remainingLabel;
            document.getElementById('statusText').textContent = data.statusText;
            document.getElementById('priceLabel').textContent = data.priceLabel;
            document.getElementById('rateLabel').textContent = data.rateLabel;
            document.getElementById('mintedLabel').textContent = data.mintedLabel;
            document.getElementById('tokenLabel').textContent = data.tokenLabel;
            document.getElementById('mintTitle').textContent = data.mintTitle;
            document.getElementById('currentWallet').textContent = data.currentWallet;
            document.getElementById('bnbAmountLabel').textContent = data.bnbAmountLabel;
            document.getElementById('minAmount').textContent = data.minAmount;
            document.getElementById('maxAmount').textContent = data.maxAmount;
            document.getElementById('receiveLabel').textContent = data.receiveLabel;
            document.getElementById('mintBtnText').textContent = data.mintBtnText;
            document.getElementById('connectText').textContent = data.connectText;
            document.getElementById('userMintedLabel').textContent = data.userMintedText;
            document.getElementById('mintCountLabel').textContent = data.mintCountLabel;
            
            // 更新按钮文本
            document.getElementById('langSwitch').innerHTML = lang === 'zh' ? 
                '<span>EN</span><i class="fas fa-globe"></i>' : 
                '<span>中文</span><i class="fas fa-globe"></i>';
        }
        
        // 更新进度条
        function updateProgressBar() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            const percentage = (currentRaised / targetAmount) * 100;
            progressFill.style.width = `${percentage}%`;
            progressText.textContent = `${percentage.toFixed(2)}%`;
            
            // 更新数据
            document.getElementById('raisedAmount').textContent = currentRaised.toFixed(2) + " BNB";
            document.getElementById('remainingAmount').textContent = (targetAmount - currentRaised).toFixed(2) + " BNB";
            document.getElementById('mintedAmount').textContent = Math.floor(currentRaised * 50000).toLocaleString();
            
            // 超过100%时改变颜色
            if (percentage >= 100) {
                progressFill.style.background = 'linear-gradient(to right, #ff6b6b, #ff9e7d)';
                document.getElementById('statusText').textContent = 
                    currentLanguage === 'zh' ? "超额完成!" : "Overfunded!";
            }
        }
        
        // 更新接收代币数量
        function updateReceiveAmount() {
            const bnbAmount = parseFloat(document.getElementById('bnbAmount').value) || 0;
            const receiveInput = document.getElementById('receiveAmount');
            const data = languageData[currentLanguage];
            
            // 验证输入
            if (bnbAmount < 0.02) {
                receiveInput.value = data.errorMin;
                return;
            }
            
            if (bnbAmount > 1) {
                receiveInput.value = data.errorMax;
                return;
            }
            
            // 检查是否为0.02的倍数
            if (bnbAmount % 0.02 !== 0) {
                receiveInput.value = data.errorMultiplier;
                return;
            }
            
            // 计算接收的代币数量
            const tokens = (bnbAmount / 0.02) * 1000;
            receiveInput.value = `${tokens.toLocaleString()} DRUDGE`;
        }
        
        // 连接钱包
        async function connectWallet() {
            const data = languageData[currentLanguage];
            
            try {
                // 请求账户访问
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                currentAccount = accounts[0];
                
                // 显示钱包地址
                const shortAddress = currentAccount.substring(0, 6) + '...' + currentAccount.substring(currentAccount.length - 4);
                document.getElementById('walletAddress').textContent = shortAddress;
                showMessage(data.successConnect, "success");
                
                // 更新按钮状态
                document.getElementById('connectBtn').innerHTML = 
                    `<i class="fas fa-check"></i> <span>${data.connectText}</span>`;
                document.getElementById('connectBtn').style.background = 'linear-gradient(to right, #1a936f, #0d7a5f)';
                
                // 获取用户铸造次数
                try {
                    const count = await drudgeContract.methods.mintCount(currentAccount).call();
                    userMintedCount = parseInt(count);
                    document.getElementById('userMinted').textContent = (userMintedCount * 1000).toLocaleString();
                    document.getElementById('mintCount').textContent = `${userMintedCount}/3`;
                } catch (error) {
                    console.error("获取铸造次数失败:", error);
                }
            } catch (error) {
                showMessage(data.errorConnect, "error");
                console.error("连接钱包失败:", error);
            }
        }
        
        // 铸造代币
        async function mintTokens() {
            const bnbAmount = parseFloat(document.getElementById('bnbAmount').value);
            const data = languageData[currentLanguage];
            
            // 验证钱包连接
            if (!currentAccount) {
                showMessage(data.errorWallet, "error");
                return;
            }
            
            // 验证输入
            if (isNaN(bnbAmount) || bnbAmount < 0.02) {
                showMessage(data.errorMin, "error");
                return;
            }
            
            if (bnbAmount > 1) {
                showMessage(data.errorMax, "error");
                return;
            }
            
            if (bnbAmount % 0.02 !== 0) {
                showMessage(data.errorMultiplier, "error");
                return;
            }
            
            // 计算乘数
            const multiplier = Math.round(bnbAmount / 0.02);
            
            // 检查铸造次数限制
            if (userMintedCount + multiplier > 3) {
                const remainingMints = 3 - userMintedCount;
                showMessage(`${data.errorMintLimit} ${remainingMints}`, "error");
                return;
            }
            
            // 转换金额为wei
            const bnbWei = web3.utils.toWei(bnbAmount.toString(), 'ether');
            
            // 显示交易进行中消息
            showMessage(currentLanguage === 'zh' ? "交易进行中，请确认钱包..." : "Processing transaction, confirm in wallet...", "info");
            document.getElementById('mintBtn').disabled = true;
            
            try {
                // 模拟铸造过程
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // 交易成功
                const tokens = multiplier * 1000;
                let message = `${data.successMint} ${tokens.toLocaleString()} DRUDGE`;
                
                // 更新状态
                currentRaised += bnbAmount;
                userMintedCount += multiplier;
                
                // 更新UI
                updateProgressBar();
                document.getElementById('userMinted').textContent = (userMintedCount * 1000).toLocaleString();
                document.getElementById('mintCount').textContent = `${userMintedCount}/3`;
                
                if (currentRaised > targetAmount) {
                    message += currentLanguage === 'zh' ? " (已超额)" : " (Overfunded)";
                }
                
                showMessage(message, "success");
                animateMintSuccess();
                
            } catch (error) {
                console.error("铸造失败:", error);
                showMessage(data.errorMint, "error");
            } finally {
                document.getElementById('mintBtn').disabled = false;
            }
        }
        
        // 显示消息
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = "message " + type;
            messageDiv.style.display = "block";
            
            // 3秒后隐藏消息
            if (type) {
                setTimeout(() => {
                    messageDiv.style.display = "none";
                }, 3000);
            }
        }
        
        // 铸造成功动画
        function animateMintSuccess() {
            const mintBtn = document.getElementById('mintBtn');
            mintBtn.style.animation = "pulse 0.5s ease-in-out";
            
            setTimeout(() => {
                mintBtn.style.animation = "";
            }, 500);
            
            // 创建多个金币元素
            const coinsCount = 15;
            for (let i = 0; i < coinsCount; i++) {
                createCoinAnimation();
            }
        }
        
        // 创建金币动画
        function createCoinAnimation() {
            const coin = document.createElement('div');
            coin.innerHTML = '<i class="fas fa-coins"></i>';
            coin.style.position = 'fixed';
            coin.style.top = '50%';
            coin.style.left = '50%';
            coin.style.transform = 'translate(-50%, -50%)';
            coin.style.fontSize = '2rem';
            coin.style.color = '#ffcc00';
            coin.style.zIndex = '1000';
            coin.style.opacity = '1';
            document.body.appendChild(coin);
            
            // 随机目标位置
            const targetX = (Math.random() - 0.5) * 300;
            const targetY = (Math.random() - 0.5) * 300 - 100;
            
            // 动画效果
            const animation = coin.animate([
                { 
                    opacity: 1, 
                    transform: 'translate(-50%, -50%) scale(1) rotate(0deg)' 
                },
                { 
                    opacity: 0, 
                    transform: `translate(${targetX}px, ${targetY}px) scale(0.5) rotate(${Math.random() * 360}deg)` 
                }
            ], {
                duration: 1500,
                easing: 'ease-out'
            });
            
            animation.onfinish = () => {
                coin.remove();
            };
        }
        
        // 语言数据
        const languageData = {
            zh: {
                title: "Drudge代币铸造",
                subtitle: "讽刺当代牛马生活的动漫风格Meme代币 - 用幽默反抗996",
                memeText: '"加班使我快乐，工资使我自由"',
                progressTitle: "铸造进度",
                raisedLabel: "已募集",
                targetLabel: "目标: 5 BNB",
                remainingLabel: "剩余额度",
                statusText: "即将售罄",
                priceLabel: "当前价格",
                rateLabel: "= 1000 DRUDGE",
                mintedLabel: "已铸造",
                tokenLabel: "DRUDGE代币",
                mintTitle: "铸造您的Drudge代币",
                currentWallet: "当前钱包:",
                bnbAmountLabel: "输入BNB数量",
                minAmount: "最小: 0.02 BNB",
                maxAmount: "最大: 1 BNB",
                receiveLabel: "您将收到",
                mintBtnText: "铸造代币",
                connectText: "连接钱包",
                userMintedText: "您已铸造:",
                mintCountLabel: "铸造次数",
                successMint: "铸造成功! 您获得了",
                successConnect: "钱包已连接",
                errorMin: "请输入至少0.02 BNB",
                errorMax: "每次最多铸造1 BNB",
                errorMultiplier: "金额必须是0.02 BNB的倍数",
                errorMintLimit: "本地址最多可铸造3次，剩余次数:",
                errorWallet: "请先连接钱包",
                errorMint: "铸造失败，请重试",
                errorConnect: "连接钱包失败"
            },
            en: {
                title: "Drudge Token Minting",
                subtitle: "Anime-style Meme Token Satirizing Modern Life - Humor Against 996",
                memeText: '"Overtime makes me happy, salary makes me free"',
                progressTitle: "Minting Progress",
                raisedLabel: "Raised",
                targetLabel: "Target: 5 BNB",
                remainingLabel: "Remaining",
                statusText: "Almost Sold Out",
                priceLabel: "Current Price",
                rateLabel: "= 1000 DRUDGE",
                mintedLabel: "Minted",
                tokenLabel: "DRUDGE Tokens",
                mintTitle: "Mint Your Drudge Tokens",
                currentWallet: "Current Wallet:",
                bnbAmountLabel: "Enter BNB Amount",
                minAmount: "Min: 0.02 BNB",
                maxAmount: "Max: 1 BNB",
                receiveLabel: "You Will Receive",
                mintBtnText: "Mint Tokens",
                connectText: "Connect Wallet",
                userMintedText: "You've minted:",
                mintCountLabel: "Mint Count",
                successMint: "Minting successful! You received",
                successConnect: "Wallet connected",
                errorMin: "Please enter at least 0.02 BNB",
                errorMax: "Maximum 1 BNB per mint",
                errorMultiplier: "Amount must be multiple of 0.02 BNB",
                errorMintLimit: "Maximum 3 mints per address, remaining:",
                errorWallet: "Please connect wallet first",
                errorMint: "Minting failed, please try again",
                errorConnect: "Failed to connect wallet"
            }
        };
        
        // 初始语言
        let currentLanguage = 'zh';
    </script>
</body>
</html>